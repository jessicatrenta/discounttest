"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useBuyerJourneyIntercept = exports.useBuyerJourney = void 0;
const react_1 = require("react");
const api_1 = require("./api");
/**
 * Returns the `buyerJourney` details on buyer progression in checkout.
 */
function useBuyerJourney() {
    return (0, api_1.useExtensionApi)().buyerJourney;
}
exports.useBuyerJourney = useBuyerJourney;
/**
 * Returns a function to intercept and block navigation in checkout.
 */
function useBuyerJourneyIntercept(interceptor) {
    const buyerJourney = useBuyerJourney();
    const interceptorRef = (0, react_1.useRef)(interceptor);
    interceptorRef.current = interceptor;
    (0, react_1.useEffect)(() => {
        const teardownPromise = buyerJourney.intercept((interceptorProps) => interceptorRef.current(interceptorProps));
        return () => {
            teardownPromise.then((teardown) => teardown()).catch(() => { });
        };
    }, [buyerJourney]);
}
exports.useBuyerJourneyIntercept = useBuyerJourneyIntercept;
